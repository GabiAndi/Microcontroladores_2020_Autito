#ifndef INC_DATATYPES_H_
#define INC_DATATYPES_H_

/**********************************************************************************/
/*********************************** Includes *************************************/
/**********************************************************************************/
#include <inttypes.h>

#include "ticker.h"
/**********************************************************************************/
/**********************************************************************************/
/**********************************************************************************/

/**********************************************************************************/
/*********************************** Defines **************************************/
/**********************************************************************************/

/************************ Tama√±o del buffer de datos ADC **************************/
#define ADC_BUFFER_LENGTH			60
/**********************************************************************************/

/**********************************************************************************/
/**********************************************************************************/
/**********************************************************************************/

/**********************************************************************************/
/*********************************** Typedef **************************************/
/**********************************************************************************/

/******************************** Datos del ADC ***********************************/
typedef struct
{
	volatile uint16_t data[50][6];

	volatile uint8_t data_index;

	volatile uint16_t mean[6];
}adc_buffer_t;
/**********************************************************************************/

/****************************** Datos en la flash *********************************/
typedef struct
{
	uint8_t ssid[30];
	uint8_t ssid_length;

	uint8_t psw[30];
	uint8_t psw_length;

	uint8_t ip_mcu[20];
	uint8_t ip_mcu_length;

	uint8_t ip_pc[20];
	uint8_t ip_pc_length;

	uint8_t port[10];
	uint8_t port_length;

	uint8_t padding[1024 - 31 - 31 - 21 - 21 - 11 - 1];

	uint8_t checksum;
}__attribute__ ((packed)) system_flash_data_t;
/**********************************************************************************/

/******************************* Convertir datos **********************************/
typedef union
{
	uint8_t u8[4];
	uint16_t u16[2];
	uint32_t u32;

	int8_t i8[4];
	int16_t i16[2];
	int32_t i32;

	float f;
}system_byte_converter_u;
/**********************************************************************************/

/*********************************** Bufferes *************************************/
typedef struct
{
	volatile uint8_t data[256];
	volatile uint8_t read_index;
	volatile uint8_t write_index;
}system_ring_buffer_t;
/**********************************************************************************/

/*********************************** Comandos *************************************/
typedef struct
{
	system_ring_buffer_t *buffer_read;

	uint8_t read_state;
	uint8_t read_payload_init;
	uint8_t read_payload_length;

	ticker_t *read_time_out;

	system_ring_buffer_t *buffer_write;
}system_cmd_manager_t;
/**********************************************************************************/

/**********************************************************************************/
/**********************************************************************************/
/**********************************************************************************/

#endif /* INC_DATATYPES_H_ */
